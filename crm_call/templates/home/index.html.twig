{% extends 'base.html.twig' %}

{% block title %}Zanova CRM | High Performance{% endblock %}

{% block body %}
<div id="full-app" class="theme-dark">
    <!-- Overlay de Chargement -->
    <div id="global-loader" class="loader-overlay hidden">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Synchronisation Zanova...</p>
        </div>
    </div>

    <!-- √âcran de Login -->
    <div id="auth-screen" class="screen animate-fade-in">
        <div class="auth-card">
            <div class="auth-header">
                <div class="logo-circle">Z</div>
                <h1>Zanova<span class="accent">CRM</span></h1>
                <p>Syst√®me de gestion haute performance</p>
            </div>
            
            <div class="auth-body">
                <div id="auth-error" class="hidden alert-box error"></div>
                
                <div class="input-group">
                    <label>Email Professionnel</label>
                    <input type="email" id="email" value="admin@zanova.com" placeholder="nom@zanova.com">
                </div>
                
                <div class="input-group">
                    <label>Mot de passe</label>
                    <input type="password" id="password" value="admin123" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>

                <button id="btn-login" class="btn-glow">
                    <span>Acc√©der √† la plateforme</span>
                </button>
            </div>
            <div class="auth-footer">
                <button onclick="App.toggleTheme()" class="btn-theme-minimal">üé® Changer de mode</button>
            </div>
        </div>
    </div>

    <!-- Dashboard Principal -->
    <div id="main-dashboard" class="screen hidden">
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo-mini">Z</div>
                <h2 class="sidebar-label">Zanova</h2>
                <button id="sidebar-toggle" class="btn-collapse">‚óÄ</button>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="App.switchView('dashboard')">
                    <span class="icon">üìä</span> <span class="sidebar-label">Tableau de bord</span>
                </a>
                <a href="#" class="nav-item" onclick="App.switchView('campaigns')">
                    <span class="icon">üéØ</span> <span class="sidebar-label">Campagnes</span>
                </a>
                <a href="#" class="nav-item" onclick="App.switchView('contacts')">
                    <span class="icon">üë•</span> <span class="sidebar-label">R√©pertoire Contacts</span>
                </a>
                <a href="#" class="nav-item" onclick="App.switchView('users')">
                    <span class="icon">üõ°Ô∏è</span> <span class="sidebar-label">√âquipe & Acc√®s</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-info sidebar-label">
                    <p id="user-name">Chargement...</p>
                    <span id="user-role" class="badge">Role</span>
                </div>
                <button id="btn-logout" class="btn-icon" title="D√©connexion">üîì</button>
            </div>
        </aside>

        <main class="content-area">
            <header class="top-header">
                <div class="header-left">
                    <button id="mobile-menu-toggle" class="btn-mobile">‚ò∞</button>
                    <h2 id="page-title">Tableau de Bord</h2>
                </div>
                <div class="top-actions">
                    <button onclick="App.toggleTheme()" class="btn-icon-alt" title="Mode Sombre/Clair">üåì</button>
                    <div class="status-box">
                        <span class="status-indicator"></span> 
                        <span class="res-hide">Serveur Op√©rationnel</span>
                    </div>
                </div>
            </header>

            <div id="view-container" class="view-content">
                <!-- Vue Overview -->
                <div id="overview-view" class="view">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <label>Campagnes Actives</label>
                            <h3 id="stat-campaigns">0</h3>
                        </div>
                        <div class="stat-card">
                            <label>Agents Connect√©s</label>
                            <h3 id="stat-agents">0</h3>
                        </div>
                        <div class="stat-card">
                            <label>Total Appels Jour</label>
                            <h3 id="stat-calls">0</h3>
                        </div>
                    </div>
                    
                    <div class="dashboard-panels">
                        <section class="panel">
                            <h3>Activit√© R√©cente</h3>
                            <div id="activity-log" class="log-list">
                                <p class="empty text-dim">Aucune activit√© r√©cente.</p>
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Vue Campagnes -->
                <div id="campaigns-view" class="view hidden">
                    <div class="view-header-flex">
                        <div class="title-group">
                            <h2 style="font-family: 'Outfit'; font-weight: 800; font-size: 2rem; margin: 0;">Gestion des Campagnes</h2>
                            <p style="color: var(--text-dim); margin: 5px 0 0 0;">Pilotez et optimisez vos op√©rations d'appels</p>
                        </div>
                        <button onclick="UI.showCampaignModal()" class="btn-glow">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-20v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path></svg>
                            Lancer une campagne
                        </button>
                    </div>
                    
                    <div class="panel" style="margin-top: 2.5rem;">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Campagne</th>
                                        <th>P√©riode</th>
                                        <th>Responsable</th>
                                        <th>Contacts</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="campaign-list-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Vue Contacts -->
                <div id="contacts-view" class="view hidden">
                    <div class="view-header-flex">
                        <div class="title-group">
                            <h2 style="font-family: 'Outfit'; font-weight: 800; font-size: 2rem; margin: 0;">R√©pertoire Global</h2>
                            <p style="color: var(--text-dim); margin: 5px 0 0 0;">Visualisez l'ensemble de vos contacts prospect√©s</p>
                        </div>
                    </div>
                    
                    <div class="dashboard-panels" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header">
                                <h3>Liste des Contacts</h3>
                                <div id="contact-actions-area"></div>
                            </div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Contact</th>
                                            <th>Coordonn√©es</th>
                                            <th>Source</th>
                                            <th>Statut</th>
                                        </tr>
                                    </thead>
                                    <tbody id="contact-list-body">
                                        <tr><td colspan="4" style="text-align:center; padding:3rem; color:var(--text-dim);">Veuillez s√©lectionner une campagne √† gauche.</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="panel">
                             <div class="panel-header"><h3>Campagnes</h3></div>
                             <div id="contact-campaign-selector" style="display:flex; flex-direction:column; gap:8px;">
                                 <!-- Rempli par JS -->
                             </div>
                        </div>
                    </div>
                </div>

                <!-- Vue √âquipe -->
                <div id="users-view" class="view hidden">
                    <div class="view-header-flex">
                        <div class="title-group">
                            <h2 style="font-family: 'Outfit'; font-weight: 800; font-size: 2rem; margin: 0;">Gestion d'√âquipe</h2>
                            <p style="color: var(--text-dim); margin: 5px 0 0 0;">G√©rez vos agents et superviseurs</p>
                        </div>
                        <button onclick="UI.showUserModal()" class="btn-glow">
                            <svg fill="currentColor" viewBox="0 0 20 20"><path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"></path></svg>
                            Ajouter un membre
                        </button>
                    </div>
                    
                    <div class="panel" style="margin-top: 2.5rem;">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Membre</th>
                                        <th>Email</th>
                                        <th>R√¥le</th>
                                        <th>Statut</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="user-list-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Generic -->
            <div id="modal-container" class="modal-overlay hidden">
                <div class="modal-card">
                    <div class="modal-header">
                        <h3 id="modal-title">Formulaire</h3>
                        <button onclick="UI.closeModal()" class="btn-close">√ó</button>
                    </div>
                    <div id="modal-body" class="modal-content"></div>
                    <div class="modal-footer">
                        <button id="modal-save" class="btn-glow">Enregistrer</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}
